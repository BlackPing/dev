var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var g=a[e];if(b.call(c,g,e,a))return{i:e,v:g}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");
$(document).ready(function(){CattingOption();select();socket();$("#socket-container").on("contextmenu",function(){return!1});$("textarea").on("keydown",function(a){var b="";if(13==a.keyCode)if(a.shiftKey){a=$("textarea").attr("rows");var c=$("textarea").val().split("\n");if(c.length>=a){for(var d=0;d<a;d++)b+=c[d],d<a-1&&(b+="\n");$("textarea").val(b)}}else a.preventDefault(),$("textarea").val(),$("textarea").val("")});$("#select-refresh").on("click",function(a){select()});$("#search").on("click",
function(a){select($("#search-text").val())})});
function select(a){var b=!1;return getData("POST","/topicsl",{search:a},function(a){a=JSON.parse(a);if(0==a.status)getMessage(a.msg)||alert("\ub124\ud2b8\uc6cc\ud06c \uc624\ub958\uc785\ub2c8\ub2e4.");else{$("#channel").empty();for(var d,e=0;e<a.select.length;e++)d='<div class="channel-topic">',d+='<span class="channel-no">NO: '+a.select[e].NO+"</span>",d+='<span class="channel-master">Master: '+a.select[e].NICKNAME+"</span>",a.create[a.select[e].NO]&&(d+='<span class="channel-delete">\uc0ad\uc81c</span>'),
d+='<div class="channel-title">'+a.select[e].TITLE+"</div>",a.topic[a.select[e].NO]&&(d+='<button class="channel-btn"><img src="/res/img/checked-symbol.png" height="20px"></button>',b=!0),b||(d+='<button class="channel-btn">\uad6c\ub3c5</button>'),$("#channel").append(d),d="",b=!1;$(".channel-btn").off().on("click",function(a){a=$(this).parent().children(".channel-no").text();a=a.substr(4,a.length);getData("POST","topicup",{no:a},function(a){a=JSON.parse(a);0==a.status?getMessage(a.msg)||alert("\ub124\ud2b8\uc6cc\ud06c \uc624\ub958\uc785\ub2c8\ub2e4."):
(getMessage(a.msg),select(),topicselect())})});$(".channel-delete").off().on("click",function(a){confirm("\uc815\ub9d0 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")&&(a=$(this).parent().children(".channel-no").text(),a=a.substr(4,a.length),getData("POST","/topicdel",{no:a},function(a){a=JSON.parse(a);0==a.status?getMessage(a.msg)||alert("\ub124\ud2b8\uc6cc\ud06c \uc624\ub958\uc785\ub2c8\ub2e4."):(select(),topicselect(),getMessage(a.msg))}))})}})}
function topicselect(){return getData("POST","/topicDynamic",{},function(a){a=JSON.parse(a);if(0==a.status)getMessage(a.msg)||alert("\ub124\ud2b8\uc6cc\ud06c \uc624\ub958\uc785\ub2c8\ub2e4.");else{$("#app-topic").empty();for(var b='<img id="topic-refresh" title="\uc0c8\ub85c\uace0\uce68" class="refresh" src="/res/img/refresh-arrow.png">',c=0;c<a.topic.length;c++)b+='<div class="app-topic-list">',b+="<span>NO: "+a.topic[c].TOPIC_NO+"</span> ",b+="<span>"+a.topic[c].TITLE+'</span><span class="topic-up">\ucc38\uc5ec</span><span style="float: right;">\uc811\uc18d\uc911\uc778 \uc720\uc800 '+
a.account[a.topic[c].TOPIC_NO]+"\uba85</span>",b+="</div>";$("#app-topic").append(b);$("#topic-refresh").on("click",function(a){topicselect()});$(".channel-btn").off().on("click",function(a){a=$(this).parent().children(".channel-no").text();a=a.substr(4,a.length);getData("POST","topicup",{no:a},function(a){a=JSON.parse(a);0==a.status?getMessage(a.msg)||alert("\ub124\ud2b8\uc6cc\ud06c \uc624\ub958\uc785\ub2c8\ub2e4."):(getMessage(a.msg),void 0!=Socket&&select())})});$(".app-topic-list span").off().on("click",
function(a){function b(a){var b=$("td").eq(a).attr("data-topic"),c=$("#app-topic"),d=$("#app-chat");textarea=b;$("td").siblings().addClass("opacity");"main"==b?(textarea=0,c.removeClass("hidden"),d.addClass("hidden"),c.removeClass("opacity"),$("#topic-list").removeClass("opacity")):(d.removeClass("hidden"),c.addClass("hidden"),$("#app-chat").children().siblings().addClass("hidden"),$("#app-chat").children('div[data-topic="'+b+'"]').removeClass("hidden"),$("td").eq(a).removeClass("opacity"))}a=$(this).parent().children("span").eq(0).text();
var d=$(this).parent().children("span").eq(1).text(),c=$("#app-chat"),f=$("#topic-connectionlist tr");a=a.substr(4,a.length);if(5<f.children().length)alert("5\uac1c\uc758 \ucc44\ub110\ub9cc \uc774\uc6a9 \uac00\ub2a5 \ud569\ub2c8\ub2e4.");else if(0<$('.app-chat[data-topic="'+a+'"]').length)f.children().removeClass("opacity"),f.children().addClass("opacity"),$('td[data-topic="'+a+'"]').removeClass("opacity"),c.removeClass("hidden"),$("#app-topic").addClass("hidden"),c.children().addClass("hidden"),
$('.app-chat[data-topic="'+a+'"]').removeClass("hidden"),textarea=a;else{f.children().removeClass("opacity");f.children().addClass("opacity");var k='<td data-topic="'+a+'"><div class="txt_line" title="'+d+'">'+d+"</div></td>";c.append('<div class="app-chat" data-topic="'+a+'"><div class="ChatList"></div><div class="UserList"><div class="UserCount">\ucc44\ud305\uc911\uc778 \ud68c\uc6d0 : <span class="color-red"><span class="Counting">0</span> \uba85</span></div><div class="UsernickName"></div></div></div>');
f.append(k);c.removeClass("hidden");$("#app-topic").addClass("hidden");c.children().addClass("hidden");$('.app-chat[data-topic="'+a+'"]').removeClass("hidden");$('.app-chat[data-topic="'+a+'"]').children(".ChatList").append('<div class="text-center connect">'+d+" \ucc44\ub110 \uc785\ub2c8\ub2e4 \uc990\uac70\uc6b4 \ucc44\ud305 \ub418\uc138\uc694~!<div>");textarea=a;click_index=f.children().length-1;sendMessage("connect",a,"Connect!!!",Option);$("td").off().on("click",function(){click_index=$(this).index();
b(click_index)});$("td").on("contextmenu",function(){return!1});$("td").on("mousedown",function(a){if(2==a.button||3==a.which){a.preventDefault();var c=$(this);if(!c.hasClass("topic-list")){var d=$("#modal-cancel");d.empty();var e=document.createElement("div");e.id="cancel-modal";e.className="cancel-modal";d.append(e);$("#cancel-modal").append('<div id="topic-close">\ub2eb\uae30</div><div id="topic-cancel">\ucde8\uc18c</div>');$("#cancel-modal").offset({left:a.pageX,top:a.pageY});$("#cancel-modal").off().on("contextmenu",
function(){return!1});$("#topic-cancel").off().on("click",function(a){d.empty()});$("#topic-close").off().on("click",function(a){b(--click_index);sendMessage("disconnect",c.attr("data-topic"),"Disconnect!!!",Option);d.empty();c.remove();$('.app-chat[data-topic="'+c.attr("data-topic")+'"]').remove()})}}});$("#clean").off().on("click",function(a){0!=textarea&&($('.app-chat[data-topic="'+textarea+'"]').children(".ChatList").empty(),$('.app-chat[data-topic="'+textarea+'"]').children(".ChatList").append('<div class="text-center">\ucc44\ud305\ucc3d\uc744 \uccad\uc18c\ud588\uc2b5\ub2c8\ub2e4.</div>'))})}})}})}
function socket(){return a_getData("POST","/logincheck",{},function(a){a=JSON.parse(a);a.status&&($(".loader").removeClass("display-none"),Connect())})}
function Connect(){Socket=new WebSocket("ws://dev.blackping.shop:8080/echo/websocket");Socket.onopen=function(){$(".loader").addClass("display-none");topicselect();sendMessage=function(a,b,c,d){Socket.send(a+"/"+b+"/"+JSON.stringify(d)+"/"+c)}};onMessage=function(a){var b=JSON.parse(a.data),c=b.type;a=b.msg;var d=b.roomNumber,e=b.userList,g="",h=$('.app-chat[data-topic="'+d+'"]').children(".UserList"),f=$('.app-chat[data-topic="'+d+'"]').children(".ChatList");if("error"==c)Socket.close(),alert(b.msg);else if("connect"==
c||"disconnect"==c){$('.app-chat[data-topic="'+d+'"]').children().find(".Counting").text(b.count);for(b=0;b<e.length;b++)g+='<div class="User" data-nickname="'+e[b]+'">'+e[b]+"</div>";h.children(".UsernickName").empty();h.children(".UsernickName").append(g);f.append(a);$(".User").off().on("click",function(){var a=document.createElement("div");a.id="user-modal";$("#user-add-modal").append(a);$("#user-modal")})}else"send"==c&&($('.app-chat[data-topic="'+d+'"]').children(".ChatList").append(a),a=$(".chatmsg").last().parent().height()-
3,$(".chatnick").last().css("position","relative"),$(".chatnick").last().css("bottom",a/2-$(".chatnick").last().height()/2));$(".ChatList").scrollTop($(".ChatList").prop("scrollHeight"))};Socket.onmessage=onMessage}
function CattingOption(){var a=$("#font-family").val(),b=$("#font-size").val(),c="#"+$("#font-color").val(),d="#"+$("#back-color").val(),e=$("#font-strong").is(":checked"),g=$("#font-i").is(":checked"),h=$("#font-underline").is(":checked"),f=$("#chatting");f.css("font-family",a);f.css("font-size",b);f.css("color",c);e?f.css("font-weight",700):f.css("font-weight","");g?f.css("font-style","italic"):f.css("font-style","");h?f.css("text-decoration","underline"):f.css("text-decoration","");Option={"font-family":a,
"font-size":b,color:c,"font-weight":e,"font-style":g,"text-decoration":h,"background-color":d}};
